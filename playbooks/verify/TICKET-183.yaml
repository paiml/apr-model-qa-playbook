# Verification Playbook for TICKET-183
# VERIFIED: Magic byte comparison was correct; enhanced error messages added
# Fix Location: src/format/gguf.rs:813-828, src/format/validation.rs:581-602
#
# Run with: apr-qa tools <model.gguf> --no-gpu

name: verify-ticket-183
version: "1.0.0"
description: "Verify fix for TICKET-183: apr validate accepts GGUF v3"

verification_gates:
  - id: V-TICKET-183-001
    description: "apr validate exits with code 0 on valid GGUF v3"
    tool: validate
    condition: "exit_code == 0"

  - id: V-TICKET-183-002
    description: "apr validate does not report false magic byte error"
    tool: validate
    condition: "!stderr.contains('Invalid magic')"

  - id: V-TICKET-183-003
    description: "apr validate supports GGUF version 3"
    tool: validate
    condition: "!stderr.contains('Unsupported version')"

  - id: V-TICKET-183-004
    description: "apr validate reports VALID for working models"
    tool: validate
    condition: "stdout.contains('VALID') || exit_code == 0"

  - id: V-TICKET-183-005
    description: "F-VALIDATE-001 gate passes"
    gate: F-VALIDATE-001
    condition: "exit_code == 0"

acceptance:
  validate_exit_code: 0
  no_false_negatives: "true"
  tool_coverage: 100  # 9/9 tools pass

metadata:
  ticket: "https://github.com/paiml/aprender/issues/183"
  severity: P2
  component: apr-cli/validate
  discovered: "2026-01-30"
  fixed: "2026-01-30"
  fix_location: "src/format/gguf.rs:813-828, src/format/validation.rs:581-602"
  pmat_contract: "PMAT-195"
  note: "Original magic byte comparison was correct; added better error messages"
